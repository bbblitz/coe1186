//package system;

public class Main {

	/**
	 * @param args
	 * @throws InterruptedException 
	 */
	public static void main(String[] args) throws InterruptedException {
		System.out.println("*********************************************");
		System.out.println("         TRAIN CONTROLLER PROTOTYPE          ");
		System.out.println("*********************************************");
		
		TrainModel trainModel = new TrainModel(37103.86);	// train mass
		TrainController trainController = new TrainController(1, trainModel);

		// controlled by timed loop in future
		long TIME_INTERVAL = 1000;
		
		// fake the train already moving
		double CURRENT_SPEED = 10.0;
		trainModel.setCurrentVelocity(CURRENT_SPEED);
		
		// fake some speed+auth commands
		double TARGET_SPEED = 25.0;
		double AUTH = 300.0;
		trainController.hackVelocityFromCTC(TARGET_SPEED);
		trainController.hackVelocityFromTrainOperator(TARGET_SPEED);
		trainController.hackAuthorityFromCTC(AUTH);
		
		
		// an informed user is a happy user
		System.out.println("Train is moving at " + CURRENT_SPEED + "mph, and received a command to accelerate to " + TARGET_SPEED + "mph with authority of " + AUTH + " ft.");
		System.out.println();
		
		// simulate 50 iterations
		for (int t = 0; t < 50; t++) {
			trainController.tick(TIME_INTERVAL);
						
			System.out.println("t=" + t + ": currentVelocity = " + (Math.round(trainModel.getCurrentVelocity() * 100.0) / 100.0) + "mph, powerCommand = " + (Math.round(trainController._getLastPowerCommand() * 100.0) / 100.0) + ", authority = " + (Math.round(trainController.getAuthorityFromCTC() * 100.0) / 100.0));
			Thread.sleep(TIME_INTERVAL);
		}
	}

}
